{% load static %}
<!DOCTYPE html>
<html>
<head>
    <title>FinTech. | Expenses</title>
    <link rel="stylesheet" href="{% static './expense.css' %}">
    <style>
        /* Style for the close button */
        .close-button {
            position: absolute;
            top: 10px;
            right: 10px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <a href="/dashboard"><h1>FinTech.</h1></a>

    <!-- Add Income Button -->
    <button id="addIncomeButton" onclick="showIncomeForm()">Add Expense</button>

    <!-- Income Entry Form (Initially Hidden) -->
    <div id="incomeForm" style="display: none; position: relative;">
        <!-- Close Button -->
        <span class="close-button" onclick="closeIncomeForm()">&#10006;</span>

        <h2>Add Expense Details</h2>
        <form id="incomeDetailsForm" action="/expenses" method="post">
            {% csrf_token %}
            <label for="name">Name:</label>
            <input type="text" id="name" name="name" required><br>

            <label for="category">Category:</label>
            <select class="custom-select tm-select-accounts" id="category" name="category">
                      <option selected>Select category</option>
                      {% for category in categories %}
                      <option value="{{category.id}}">{{category.name}}</option>
                      {% endfor %}
            </select><br>

            <label for="amount">Amount:</label>
            <input type="number" id="amount" name="amount" required><br>

            <label for="date">Date:</label>
            <input type="date" id="date" name="date" required><br>

            <label for="note">Note:</label>
            <textarea id="note" name="note" rows="4"></textarea><br>

            <input type="submit" value="Add" >
        </form>
    </div>

    <!-- Display Income Entries in a Table -->
    <h2 style="color: white;">Expense Entries</h2>
    <table id="incomeTable" border="1">
        <tr>
            <th>Sr.No.</th>
            <th>Name</th>
            <th>Category</th>
            <th>Amount</th>
            <th>Date</th>
            <th>Note</th>
            <th>Edit</th>
            <th>Delete</th>
        </tr>
        {% for expense in expenses %}
        <tr>
            <td>{{forloop.counter}}</td>
            <td>{{expense.name}}</td>
            <td>{{expense.category}}</td>
            <td>{{expense.amount}}</td>
            <td>{{expense.date}}</td>
            <td>{{expense.note}}</td>
            <td>
                <div class="rem">										
                    <button type="button" onclick="location.href='/edit-expense/{{expense.id}}' ">
                        <span class="glyphicon glyphicon-trash">Edit</span>
                    </button>
                </div>
            </td>
            <td>
                <div class="rem">										
                    <button type="button" onclick="location.href='/delete-expense/{{expense.id}}' ">
                        <span class="glyphicon glyphicon-trash">X</span>
                    </button>
                </div>
            </td>
        </tr>
        {% endfor %}
    </table>

    <script>
        function showIncomeForm() {
            var incomeForm = document.getElementById("incomeForm");
            incomeForm.style.display = "block";
        }

        function closeIncomeForm() {
            var incomeForm = document.getElementById("incomeForm");
            incomeForm.style.display = "none";
        }

        function addIncomeEntry() {
            var name = document.getElementById("name").value;
            var category = document.getElementById("category").value;
            var amount = document.getElementById("amount").value;
            var date = document.getElementById("date").value;
            var note = document.getElementById("note").value;

            var incomeTable = document.getElementById("incomeTable");

            var newRow = incomeTable.insertRow(-1);
            var cell1 = newRow.insertCell(0);
            var cell2 = newRow.insertCell(1);
            var cell3 = newRow.insertCell(2);
            var cell4 = newRow.insertCell(3);
            var cell5 = newRow.insertCell(4);

            cell1.innerHTML = name;
            cell2.innerHTML = category;
            cell3.innerHTML = amount;
            cell4.innerHTML = date;
            cell5.innerHTML = note;

            // Clear the form
            document.getElementById("incomeDetailsForm").reset();

            // Close the form after submission
            closeIncomeForm();
        }
    </script>
</body>
</html>
